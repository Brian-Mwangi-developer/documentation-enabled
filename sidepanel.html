<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="dark light" />
    <title>Documentation Guide</title>
    <link rel="stylesheet" href="sidepanel.css" />
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="logo-section">
          <div class="logo">üìö</div>
          <h1>Documentation Guide</h1>
        </div>
        <div class="domain-info" id="domain-info">
          <div class="domain-badge" id="domain-badge">
            <span class="domain-icon">üåê</span>
            <span class="domain-text" id="domain-text">No domain detected</span>
          </div>
          <button
            class="refresh-button"
            id="refresh-button"
            title="Refresh current tab info"
            aria-label="Refresh current tab information"
          >
            <svg
              width="16"
              height="16"
              viewBox="-0.45 0 60.369 60.369"
              xmlns="http://www.w3.org/2000/svg"
              fill="currentColor"
            >
              <g>
                <path
                  d="M504.547,265.443h-9.019a30.964,30.964,0,0,0-29.042-52.733,1.5,1.5,0,1,0,.792,2.894,27.955,27.955,0,0,1,25.512,48.253l0-10.169h-.011a1.493,1.493,0,0,0-2.985,0h0v13.255a1.5,1.5,0,0,0,1.5,1.5h13.256a1.5,1.5,0,1,0,0-3Z"
                  transform="translate(-446.571 -211.615)"
                ></path>
                <path
                  d="M485.389,267.995a27.956,27.956,0,0,1-25.561-48.213l0,10.2h.015a1.491,1.491,0,0,0,2.978,0h.007V216.791a1.484,1.484,0,0,0-1.189-1.532l-.018-.005a1.533,1.533,0,0,0-.223-.022c-.024,0-.046-.007-.07-.007H448.071a1.5,1.5,0,0,0,0,3h8.995a30.963,30.963,0,0,0,29.115,52.664,1.5,1.5,0,0,0-.792-2.894Z"
                  transform="translate(-446.571 -211.615)"
                ></path>
              </g>
            </svg>
          </button>
        </div>
      </header>

      <div class="status-section" id="status-section">
        <div class="status-message" id="status-message">
          <div class="status-icon">‚ö†Ô∏è</div>
          <p>
            Please navigate to a website to start using the Documentation Guide.
          </p>
        </div>
      </div>

      <div class="chat-section" id="chat-section" style="display: none">
        <div class="ai-status" id="ai-status">
          <div class="status-left">
            <div class="status-indicator loading" id="status-indicator"></div>
            <span id="status-text">Initializing Gemini Nano</span>
          </div>
          <div class="ai-status-controls">
            <button
              type="button"
              id="new-chat-button"
              class="ai-control-button"
              title="Start new chat"
            >
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M12 5V19M5 12H19" />
              </svg>
            </button>
            <button
              type="button"
              id="history-button"
              class="ai-control-button"
              title="Chat history"
            >
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6l4-4-4-4z"></path>
                <path d="M21 12h-6l4-4-4-4z"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="conversation" id="conversation">
          <div class="welcome-message">
            <div class="message ai-message">
              <div class="message-content">
                <p>
                  üëã Hello! I'm your Documentation Guide AI assistant. I can
                  help you understand and navigate content on
                  <span id="welcome-domain">this website</span>.
                </p>
                <p>
                  Feel free to ask me anything about the current page or domain!
                </p>
              </div>
            </div>
          </div>
        </div>

        <div class="input-section">
          <form id="chat-form" class="chat-form" role="search">
            <div class="input-container">
              <textarea
                id="prompt-input"
                placeholder="Ask me anything about this domain..."
                rows="1"
                maxlength="2000"
                aria-label="Enter your question about the documentation"
                spellcheck="true"
              ></textarea>
              <button
                type="submit"
                id="send-button"
                class="send-button"
                disabled
                aria-label="Send message"
                title="Send message (Enter)"
              >
                <svg
                  viewBox="0 0 32 32"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="currentColor"
                >
                  <path
                    d="M16,30 C8.268,30 2,23.73 2,16 C2,8.27 8.268,2 16,2 C23.732,2 30,8.27 30,16 C30,23.73 23.732,30 16,30 L16,30 Z M16,0 C7.163,0 0,7.16 0,16 C0,24.84 7.163,32 16,32 C24.837,32 32,24.84 32,16 C32,7.16 24.837,0 16,0 L16,0 Z M16.879,9.46 C16.639,9.22 16.311,9.15 16,9.21 C15.689,9.15 15.361,9.22 15.121,9.46 L9.465,15.12 C9.074,15.51 9.074,16.14 9.465,16.54 C9.854,16.93 10.488,16.93 10.879,16.54 L15,12.41 L15,23 C15,23.55 15.447,24 16,24 C16.553,24 17,23.55 17,23 L17,12.41 L21.121,16.54 C21.512,16.93 22.145,16.93 22.535,16.54 C22.926,16.14 22.926,15.51 22.535,15.12 L16.879,9.46 L16.879,9.46 Z"
                  />
                </svg>
              </button>
            </div>
          </form>

          <div class="controls">
            <div class="chat-controls">
              <button
                type="button"
                id="reset-button"
                class="control-button"
                title="Reset conversation"
              >
                <svg
                  width="14"
                  height="14"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M3 12A9 9 0 0 1 12 3A9 9 0 0 1 21 12A9 9 0 0 1 12 21"
                  />
                  <path d="M12 7V12L16 14" />
                </svg>
                Reset Chat
              </button>

              <button
                type="button"
                id="delete-chat-button"
                class="control-button delete-button"
                title="Delete current chat"
                style="display: none"
              >
                <svg
                  width="14"
                  height="14"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polyline points="3,6 5,6 21,6" />
                  <path
                    d="M19,6V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V6M8,6V4A2,2 0 0,1 10,2H14A2,2 0 0,1 16,4V6"
                  />
                  <line x1="10" y1="11" x2="10" y2="17" />
                  <line x1="14" y1="11" x2="14" y2="17" />
                </svg>
                Delete
              </button>
            </div>

            <div
              class="token-info"
              id="token-info"
              title="Tokens used in this session"
            >
              <span id="tokens-used">0</span> tokens
            </div>
          </div>
        </div>
      </div>

      <footer class="footer">
        <p>Powered by Chrome's Built-in AI + Vector Search</p>
      </footer>
    </div>

    <!-- History Modal -->
    <div id="history-modal" class="history-modal" style="display: none">
      <div class="history-modal-overlay"></div>
      <div class="history-content">
        <div class="history-header">
          <h3>Chat History</h3>
          <button id="close-history" class="close-button">√ó</button>
        </div>
        <div class="history-list" id="history-list">
          <!-- History items will be populated here -->
        </div>
      </div>
    </div>

    <script src="sidepanel.js"></script>
  </body>
</html>
